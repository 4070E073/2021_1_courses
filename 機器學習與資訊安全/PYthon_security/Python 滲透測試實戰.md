#
```
Python 滲透測試實戰
李華峰  人民郵電  2021-02-01
ISBN:7115547130
ISBN-13:9787115547132
```

```
第 1章 我們的設備是如何連接到互聯網的 1
1.1 互聯網世界的規則——協議 1
1.2 兩台設備上的應用程序是如何通過互聯網進行通信的 2
1.3 小結 7

第 2章 工欲善其事，必先利其器 8
2.1 Python的優勢 8
2.2 Python編程環境的選擇 9
2.2.1 虛擬操作系統的工具VMware 9
2.2.2 Kali Linux的下載與應用 10
2.2.3 PyCharm的下載與應用 13
2.3 小結 19

第3章 數據包的“基因編輯工具”——Scapy 20
3.1 Scapy簡介 20
3.2 Scapy中的分層結構 22
3.3 Scapy中的常用函數 24
3.4 在Scapy中發送和接收數據包 26
3.5 Scapy中的抓包函數 28
3.6 小結 30

第4章 IP地址都去哪了 31
4.1 DHCP的工作原理與流程 31
4.2 用Python程序模擬DHCP客戶端 34
4.2.1 DHCP Discover數據包的構造 35
4.2.2 DHCP Offer數據包的捕獲與解析 38
4.2.3 DHCP Request數據包的構造 39
4.3 編寫一個DHCP服務器端測試程序 41
4.4 小結 42

第5章 你能記住每個網站的IP地址嗎 43
5.1 DNS協議的工作原理與流程 43
5.2 使用Scapy模擬DNS的請求 46
5.3 黑客是如何利用DNS協議的 48
5.3.1 DNS請求泛洪攻擊 48
5.3.2 DNS放大攻擊 49
5.3.3 DNS欺騙 49
5.4 dnspython模塊的使用 51
5.5 doh-proxy模塊的使用 52
5.6 小結 54

第6章 網絡中有秘密嗎 55
6.1 中間人攻擊的原理 55
6.2 ARP的缺陷 57
6.3 使用Scapy庫編寫中間人攻擊腳本 61
6.4 用Scapy庫編寫網絡嗅探程序 63
6.4.1 將嗅探結果保存為文件 63
6.4.2 對敏感信息的提取 65
6.5 實現對HTTPS的中間人攻擊 67
6.5.1 HTTPS與HTTP的區別 67
6.5.2 證書頒發機構的工作原理 69
6.5.3 基於HTTPS的中間人攻擊 71
6.6 中間人攻擊的解決方案 76
6.6.1 靜態綁定ARP表項 76
6.6.2 使用DHCP Snooping功能 76
6.6.3 劃分VLAN 77
6.7 小結 77

第7章 用Python編寫一個遠程控製程序 78
7.1 遠程控製程序簡介 78
7.2 編寫一個基於SSH的遠程控製程序 79
7.2.1 Telnet與SSH 79
7.2.2 基於paramiko實現SSH客戶端 81
7.2.3 操作實例 83
7.3 編寫一個遠程控製程序的服務器端和客戶端 84
7.3.1 如何使用Python執行系統命令（subprocess模塊） 84
7.3.2 遠程控制的服務器端與客戶端（套接字模塊實現） 88
7.3.3 遠程控制的服務器端與客戶端（socketserver模塊實現） 91
7.4 編寫一個反向的木馬 93
7.5 編寫鍵盤監聽程序 97
7.6 監聽指定窗口的輸入 100
7.7 用Python實現截圖功能 102
7.8 使用Python控制註冊表 104
7.9 用Python控制系統進程 106
7.10 將Python腳本轉化為exe文件 109
7.11 小結 111

第8章 交換機面臨的威脅 112
8.1 交換機的工作原理 112
8.2 MAC地址泛洪攻擊 114
8.2.1 泛洪程序的構造 114
8.2.2 eNSP模擬環境的建立 114
8.2.3 通過eNSP中的雲與VMware相連 119
8.3 MAC欺騙攻擊 122
8.4 劃分VLAN對抗中間人攻擊 123
8.5 VLAN Hopping技術 124
8.6 攻擊生成樹協議 128
8.7 小結 131

第9章 用Python實現信息搜集 132
9.1 信息搜集基礎 132
9.2 用Python實現設備狀態掃描 132
9.2.1 基於ARP的活躍設備發現技術 133
9.2.2 基於ICMP的活躍設備發現技術 137
9.2.3 基於TCP的活躍設備發現技術 140
9.2.4 基於UDP的活躍設備發現技術 142
9.3 使用Python實現埠掃描 143
9.3.1 基於TCP全開的埠掃描技術 143
9.3.2 基於TCP半開的埠掃描技術 146
9.4 小結 147

第 10章 用Python對漏洞進行滲透 148
10.1 黑客發現和利用漏洞的過程 148
10.1.1 用Nmap來識別目標操作系統類型和安裝的應用程序 148
10.1.2 漏洞滲透庫exploit-db 151
10.1.3 使用Metasploit完成對目標設備的滲透 153
10.2 使用Python識別操作系統類型和安裝的應用程序 156
10.2.1 python-nmap模塊的使用 157
10.2.2 使用python-nmap模塊識別目標設備安裝的應用程序 160
10.2.3 使用python-nmap模塊識別目標操作系統 162
10.3 使用Python實現Metasploit的自動化滲透 164
10.4 小結 166

第 11章 Web應用程序運行原理 167
11.1 Web應用程序是怎樣“煉”成的 167
11.2 程序員是如何開發Web應用程序的 172
11.2.1 Web應用程序的分層結構 172
11.2.2 各司其職的程序員 173
11.3 研究Web應用程序的利器 176
11.3.1 黑盒測試類工具 176
11.3.2 白盒測試類工具 177
11.4 小結 179

第 12章 Web應用程序安全原理 180
12.1 Web服務所面臨的威脅 180
12.2 Web服務安全的外部環境因素 181
12.2.1 操作系統的漏洞 181
12.2.2 Web服務器應用程序的漏洞 185
12.2.3 Docker的缺陷 188
12.3 Web服務安全的內部代碼因素 190
12.3.1 常見的Web應用程序漏洞 190
12.3.2 Web漏洞測試程序 192
12.4 建立靶機測試環境 194
12.5 對Web服務進行信息搜集 196
12.5.1 檢測Web服務器的操作系統類型和安裝的應用程序 196
12.5.2 獲取關於目標的whois信息 198
12.6 小結 199

第 13章 簡單直接的黑客攻擊：暴力破解 200
13.1 用Burp Suite跟蹤分析登錄的過程 200
13.2 用Python編寫登錄程序 204
13.3 如何在Python程序中保持登錄狀態 207
13.4 用Python編寫針對登錄的暴力破解程序 208
13.4.1 用Python編寫生成字典文件的程序 209
13.4.2 用Python編寫一個DVWA登錄的暴力破解程序 212
13.5 針對目錄的暴力破解 214
13.6 小結 215

第 14章 Web也有“後門”——命令註入漏洞 216
14.1 命令註入漏洞產生的原因 216
14.1.1 系統命令函數 217
14.1.2 執行多條命令 218
14.2 如何利用DVWA的命令註入漏洞進行滲透 219
14.3 用Python編寫一個命令註入程序 220
14.4 如何利用命令註入漏洞實現對服務器的控制 223
14.5 命令註入漏洞的解決方案 226
14.6 小結 228

第 15章 被遺忘的角落：文件包含漏洞 229
15.1 文件包含漏洞的成因 229
15.2 文件包含漏洞攻擊實例 233
15.3 用Python編寫文件包含漏洞測試程序 235
15.4 文件包含漏洞的解決方案 237
15.5 小結 238

第 16章 令人談之色變的攻擊：SQL註入攻擊 239
16.1 SQL註入漏洞產生的原因 239
16.2 黑客是如何利用SQL註入漏洞的 243
16.2.1 利用INFORMATION_SCHEMA數據庫進行SQL註入 243
16.2.2 如何繞過程序的轉義機制 244
16.2.3 SQL Injection 245
16.3 sqlmap註入工具的使用 247
16.4 使用Python編寫的SQL註入程序 250
16.5 小結 254

第 17章 黑客入侵的捷徑：上傳攻擊 255
17.1 黑客利用上傳漏洞的各種技術 255
17.2 用Python編寫上傳漏洞滲透程序 260
17.3 應對上傳漏洞的解決方案 262
17.4 小結 263

第 18章 來自遠方的來信：跨站腳本攻擊漏洞 264
18.1 跨站腳本攻擊漏洞的成因 264
18.2 跨站腳本攻擊漏洞攻擊實例 266
18.3 用Python實現跨站腳本攻擊漏洞檢測 270
18.4 跨站腳本攻擊漏洞的解決方案 271
18.5 跨站請求偽造漏洞的分析與利用 271
18.6 小結 275

第 19章 WAF可以讓我們高枕無憂了嗎 276
19.1 入侵者如何檢測WAF 276
19.1.1 網站有無WAF保護的區別 276
19.1.2 檢測目標網站是否使用WAF 277
19.1.3 檢測目標網站使用的WAF產品 279
19.2 入侵者如何繞過雲WAF 283
19.3 常見的WAF繞過方法 285
19.3.1 利用WAF的檢測範圍 286
19.3.2 WAF與操作系統的解析差異 287
19.3.3 利用WAF與服務器應用程序的解析差異 291
19.3.4 編解碼技術的差異 293
19.3.5 其他常用方法 297
19.4 小結 298
```
